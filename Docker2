# Use the official Debian Buster base image
FROM debian:buster

# Install system dependencies
RUN apt-get update && apt-get install -y \
    libcurl4-openssl-dev \
    libssl-dev \
    libxml2-dev \
    zlib1g-dev

# Install R and required packages
RUN apt-get install -y r-base r-cran-devtools

# Install additional R packages
RUN R -e "install.packages(c('BiocManager', 'readxl', 'ggplot2', 'shiny', 'HDCytoData', 'CATALYST', 'FlowSOM', 'ConsensusClusterPlus', 'ComplexHeatmap', 'scater', 'diffcyt', 'cowplot'), repos='http://cran.rstudio.com/')"
RUN R -e "BiocManager::install(c('HDCytoData', 'CATALYST', 'FlowSOM', 'ConsensusClusterPlus', 'ComplexHeatmap', 'scater', 'diffcyt'), force=TRUE)"

# Copy your R script into the container
COPY Cytof2.R /usr/src/app/

# Expose port 3838 for Shiny app
EXPOSE 3838

# Run your script as a Shiny app
CMD ["R", "-e", "shiny::runApp('/usr/src/app/Cytof2.R', host = '0.0.0.0', port = 3838)"]
